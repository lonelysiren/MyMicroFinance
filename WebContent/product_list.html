<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>table模块快速使用</title>
  <link rel="stylesheet" href="./lib/plugins/layui2.0/css/layui.css" media="all" />
</head>
<body>
 
<div class="admin-main">
			<blockquote class="layui-elem-quote">
				产品信息
				 <button type="button" class="layui-btn layui-btn-small" style="float:right;margin:0;" id="add"> <i class="layui-icon">&#xe608;</i> 添加</button>
			</blockquote>
			<fieldset class="layui-elem-field">
				<legend>产品列表</legend>
				<div class="layui-field-box layui-form">
					<table id="product_list"  lay-filter="product_list" class="layui-table admin-table">
					</table>
				</div>
			</fieldset>
			
		</div>
 <script type="text/html" id="barDemo">
  <a class="layui-btn layui-btn-mini" lay-event="edit">编辑</a>
  <a class="layui-btn layui-btn-danger layui-btn-mini" lay-event="del">删除</a>
</script>
	<script type="text/javascript" src="./lib/plugins/layui2.0/layui.js"></script>
<script>
layui.use(['table','layer'], function(){
  var table = layui.table,$ = layui.$,layer = layui.layer;
  company_id = $('#company_id', window.parent.document).val();
  console.log(company_id)
  $('#add').click(function(){
			var $that = $(this);
			
		});
  table.render({
	  url:'./lib/datas/tableDemo.json',
	  where:{'company_id':company_id},
	  page: true,
	  limit: 15,
	  even: true,
	  elem:'#product_list',
	  cols:  [[ //标题栏
		    {field: 'id', title: 'ID', width: 80},
		    {field: 'name', title: '产品名称', width: 120},
		    {field: 'cycle', title: '周期天数', width: 100},
		    {field: 'day_rate', title: '日息', width: 80},
		    {field: 'week_rate', title: '周息', width: 80},
		    {field: 'margin_loans', title: '保证金', width: 80},
		    {field: 'management_pay', title: '管理费', width: 80},
		    {field: 'other_pay', title: '其他费用', width: 100},
		    {field: 'payment_method', title: '还款方式', width: 120},
		    {field: 'isAdvance', title: '提前还款', width: 100},
		    {field: 'produc_remak', title: '备注', width: 120},
		    {fixed: 'right', width:130, align:'center', toolbar: '#barDemo'} 
		  ]],
		  done: function(res, curr, count){
			    //如果是异步请求数据方式，res即为你接口返回的信息。
			    //如果是直接赋值的方式，res即为：{data: [], count: 99} data为当前页数据、count为数据总长度
			    console.log(res);
			    //得到当前页码
			    console.log(curr); 
			    //得到数据总量
			    console.log(count);
			  }
  })
  
  table.on('tool(product_list)', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
	  var data = obj.data; //获得当前行数据
	  var layEvent = obj.event; //获得 lay-event 对应的值
	  var tr = obj.tr; //获得当前行 tr 的DOM对象
	 if(layEvent === 'del'){ //删除
	    layer.confirm('确定删除 '+data.name+' 吗？该操作不可逆', function(index){
	      obj.del(); //删除对应行（tr）的DOM结构
	      layer.close(index);
	      //向服务端发送删除指令
	    });
	  } else if(layEvent === 'edit'){ //编辑
	    //do something
	    //同步更新缓存对应的值
	    obj.update({
	      name: '产品改'
	    });
	  }
	});
});
</script>
</body>
</html>