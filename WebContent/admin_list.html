<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="./lib/plugins/layui2.0/css/layui.css" media="all" />
		<link rel="stylesheet" href="./lib/css/main.css" />
	</head>

	<body>
		<div class="admin-main">
			<blockquote class="layui-elem-quote">
				管理员列表
				 <button type="button" class="layui-btn layui-btn-sm" style="float:right;margin:0;" id="add"> <i class="layui-icon">&#xe608;</i> 添加</button>
				
			</blockquote>
			<fieldset class="layui-elem-field">
				<legend>数据列表</legend>
				<div class="layui-field-box layui-form">
				<table id="admin_list" lay-filter="admin_list"
					class="layui-table admin-table">
				</table>
			</div>
			</fieldset>
			<div class="admin-table-page">
				<div id="paged" class="page" >
				</div>
			</div>
		</div>
		 <script type="text/html" id="barDemo">
  <a class="layui-btn layui-btn-sm" lay-event="edit">编辑</a>
  <a class="layui-btn layui-btn-danger layui-btn-sm" lay-event="del">删除</a>
</script>
<script type="text/html" id="stauts">
  {{#  if(d.stauts == 0){ }}
禁用
  {{#  } else { }}
启用
  {{#  } }}
</script>
		<script type="text/javascript" src="./lib/plugins/layui2.0/layui.js"></script>
		<script type="text/javascript"src="./lib/js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript"src="./lib/js/jquery.cookie.js"></script>
		<script type="text/javascript">
		layui.config({
			base:'lib/js/'
		});
		layui.use(['paging','element'],function(){
			var paging = layui.paging(),
			element = layui.element,
			form = layui.form,
			$ = layui.jquery,
			company_id = $('#company_id', window.parent.document).val()
			paging.init({
		url:'/user_list',
		where:{'company_id':company_id},
		elem:'#admin_list',
		cols:[[ //标题栏
		    {field: 'id', title: 'ID'},
		    {field: 'username', title: '账号'},
		    {field: 'nickname', title: '姓名'},
		    {field: 'username',  title: '最后登录时间'},
		    {field: 'username',  title: '最后登录IP'},
		    {field: 'stauts',templet: '#stauts', title: '状态'},
		    {fixed: 'right',title:'操作', width:150, align:'center', toolbar: '#barDemo'} 
		  ]],
		  filter:'admin_list',
		  done:function(res, curr, count){
      	    layui.each(res.data,function(index,value){
      	    	layui.data('admin', {
      	    	  key: value.id
      	    	  ,value: {'email':value.email,'role':value.role}
      	    	});
      	    })
      	    var localTest = layui.data('admin');
      	  },
      	render:function(odata){
      		var id = odata['id'];
  	    	$("select[name='role']").val( layui.data('admin')[id]['role']);
  	    	$("input[name='email']").val(layui.data('admin')[id]['email']);
  	    },
  	  user:function(){
  		$("input[name='company']").val($('#company', window.parent.document).html());
  	  },
  	    add:{'url':'/user_add','company_id':company_id},
		  del:{'name':'nickname','id':'id','url':'/user_del'},
		  edit:{'page':'./lib/temp/edit-admin.html','url':'/user_edit'}
	})
		});
		
		</script>
	</body>

</html>